specVersion: 0.0.2
schema:
  file: ./schema.graphql
dataSources:
  - kind: ethereum/contract
    name: Slice
    network: mainnet
    # network: rinkeby
    source:
      address: "0xcA6b9D59849EC880e82210e9cb8237E1d0cAA69e" # Mainnet
      startBlock: 13479416 # Mainnet
      # address: "0xA0554206d329e5800C8364B0dBbE9124759358c4" # Rinkeby
      # startBlock: 9499461 # Rinkeby
      # address: "0x1879E6110065f7C489623D65C3C0d8C7f14EBa87" # Rinkeby (dev)
      # startBlock: 9894702 # Rinkeby (dev)
      abi: Slice
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      entities:
        - Slicer
        - Payee
        - PayeeSlicer
      abis:
        - name: Slice
          file: ./abis/Slice.json
      eventHandlers:
        - event: TokenSliced(address,uint256,address[],uint256[],uint256,bool)
          handler: handleTokenSliced
        # - event: ProductsPaid(address[],uint32[],uint16[],uint256)
        #   handler: handleProductsPaid
        # - event: Upgraded(indexed address)
        #   handler: handleUpgraded
      file: ./src/mappings/slice.ts
  - kind: ethereum/contract
    name: SliceCore
    network: mainnet
    # network: rinkeby
    source:
      address: "0x0FD0d9aa44a05Ee158DDf6F01d7dcF503388781d" # Mainnet
      startBlock: 13346238 # Mainnet
      # address: "0x1e001ceC39cdA5C327427560f0D260741BdB38Fb" # Rinkeby
      # startBlock: 9499451 # Rinkeby
      # address: "0xDd8bc1bDce4548f11dB2D748156Eda0e904b5Aeb" # Rinkeby (dev)
      # startBlock: 9894702 # Rinkeby (dev)
      abi: SliceCore
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      entities:
        - Payee
        - PayeeSlicer
      abis:
        - name: SliceCore
          file: ./abis/SliceCore.json
      eventHandlers:
        - event: TransferSingle(indexed address,indexed address,indexed address,uint256,uint256)
          handler: handleTransferSingle
        - event: TransferBatch(indexed address,indexed address,indexed address,uint256[],uint256[])
          handler: handleTransferBatch
      file: ./src/mappings/sliceCore.ts
  - kind: ethereum/contract
    name: SLC
    network: mainnet
    # network: rinkeby
    source:
      address: "0x61bCd1ED11fC03C958A847A6687b1875f5eAcaaf" # Mainnet
      startBlock: 13475460 # Mainnet
      # address: "0x67DB6cd1877c66Ce7CE1588E86926b837A21D4Da" # Rinkeby
      # startBlock: 9499453 # Rinkeby
      # address: "0x8D1e6C6a381d33456710277bDa06f259333Cad90" # Rinkeby (dev)
      # startBlock: 9894702 # Rinkeby (dev)
      abi: SLC
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      entities:
        - Payee
      abis:
        - name: SLC
          file: ./abis/SLC.json
      eventHandlers:
        - event: MintedSLC(indexed address,uint256)
          handler: handleMintedSLC
        - event: MintTriggered(indexed address,uint256,indexed address,uint8)
          handler: handleMintTriggered
        - event: Transfer(indexed address,indexed address,uint256)
          handler: handleTransfer
      file: ./src/mappings/slc.ts
templates:
  - kind: ethereum/contract
    name: Slicer
    network: mainnet
    # network: rinkeby
    source:
      abi: Slicer
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      entities:
        - Slicer
        - PayeeSlicer
        - Product
        - ProductPurchase
      abis:
        - name: Slicer
          file: ./abis/Slicer.json
      eventHandlers:
        - event: TriggeredRelease(indexed address,uint256)
          handler: handleTriggeredSlicerRelease
        - event: AddedChildrenSlicer(indexed uint256)
          handler: handleAddedChildrenSlicer
        - event: ProductAdded(indexed uint32,indexed uint32,uint256,bool,bool,bool,uint32,indexed address,bytes,uint256[],uint32[])
          handler: handleProductAdded
        - event: ProductPaid(indexed address,indexed uint32,uint16,uint256)
          handler: handleProductPaid
        - event: PaymentReceived(indexed address,uint256)
          handler: handlePaymentReceived
        - event: ERC721Received(indexed address,indexed address,uint256)
          handler: handleERC721Received
        - event: ERC1155Received(indexed address,indexed address,uint256,uint256)
          handler: handleERC1155Received
        - event: ERC1155BatchReceived(indexed address,indexed address,uint256[],uint256[])
          handler: handleERC1155BatchReceived
        # - event: SLCPaid(uint32[],uint16[],uint256)
        #   handler: handleSLCPaid
        # - event: ProductInfoChanged(indexed uint32,bool,uint32,uint256)
        #   handler: handleProductInfoChanged
        # - event: ProductCurrencyChanged(indexed uint32,uint256,bool)
        #   handler: handleProductCurrencyChanged
        # - event: ProductCategoryChanged(indexed uint32,uint32)
        #   handler: handleProductCategoryChanged
        # - event: ProductRemoved(indexed uint32)
        #   handler: handleProductRemoved
      file: ./src/mappings/slicer.ts
