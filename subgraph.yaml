specVersion: 0.0.4
description: The decentralized slicing protocol
repository: https://github.com/slice-so/slice-subgraph
schema:
  file: ./schema.graphql
dataSources:
  - kind: ethereum/contract
    name: SliceCore
    # network: mainnet
    network: rinkeby
    source:
      # address: "" # Mainnet
      # startBlock: 13346238 # Mainnet
      address: "0x0eD3a883C699DCF8728E7383da7f81f1a32B4E7A" # Rinkeby (Testnet)
      startBlock: 10454223 # Rinkeby (Testnet)
      # address: "0x074E0b90f76109fB749f1D378FAc6a79f536d412" # Rinkeby (Staging)
      # startBlock: 10402588 # Rinkeby (Staging)
      abi: SliceCore
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - Slicer
        - Payee
        - Currency
        - PayeeSlicer
        - CurrencySlicer
      abis:
        - name: SliceCore
          file: ./abis/SliceCore.json
      eventHandlers:
        - event: TokenSliced(indexed address,indexed uint256,(address,uint32)[],uint256,address[],uint256,uint256,bool,bool,indexed uint256)
          handler: handleTokenSliced
        - event: TokenResliced(indexed uint256,address[],int32[])
          handler: handleTokenResliced
        - event: SlicerControllerSet(indexed uint256,indexed address)
          handler: handleSlicerControllerSet
        - event: RoyaltySet(indexed uint256,bool,bool,uint256)
          handler: handleRoyaltySet
        - event: TransferSingle(indexed address,indexed address,indexed address,uint256,uint256)
          handler: handleTransferSingle
        - event: TransferBatch(indexed address,indexed address,indexed address,uint256[],uint256[])
          handler: handleTransferBatch
      file: ./src/mappings/sliceCore.ts
  - kind: ethereum/contract
    name: ProductsModule
    # network: mainnet
    network: rinkeby
    source:
      # address: "" # Mainnet
      # startBlock: 13346238 # Mainnet
      address: "0xcc3f2900a9D170DBDc6C9f43B56051AbeBCaA642" # Rinkeby (Testnet)
      startBlock: 10454223 # Rinkeby (Testnet)
      # address: "0xC177F975543B419c6c5B68A4DB13cD62CE55b9EE" # Rinkeby (Staging)
      # startBlock: 10402588 # Rinkeby (Staging)
      abi: ProductsModule
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - Slicer
        - Payee
        - Product
        - PayeeSlicer
        - ProductPurchase
        - ProductPrices
        - PayeeSlicerCurrency
        - TokenListing
      abis:
        - name: ProductsModule
          file: ./abis/ProductsModule.json
      eventHandlers:
        - event: ProductAdded(indexed uint256,indexed uint256,indexed uint256,bool,bool,bool,uint256,address,bytes,(uint128,uint32)[],(uint248,bool,address)[],(bytes,uint256,address,bytes4,bytes4))
          handler: handleProductAdded
        - event: ProductInfoChanged(indexed uint256,indexed uint256,bool,bool,uint256,(uint248,bool,address)[])
          handler: handleProductInfoChanged
        - event: ProductRemoved(indexed uint256,indexed uint256)
          handler: handleProductRemoved
        - event: ProductPaid(indexed uint256,indexed uint256,uint256,indexed address,address,uint256,uint256)
          handler: handleProductPaid
        - event: ReleasedToSlicer(indexed uint256,uint256)
          handler: handleReleasedToSlicer
        - event: ERC721ListingChanged(indexed uint256,indexed address,indexed uint256,bool)
          handler: handleERC721ListingChanged
        - event: ERC1155ListingChanged(indexed uint256,indexed address,indexed uint256,uint256)
          handler: handleERC1155ListingChanged
      file: ./src/mappings/productsModule.ts
  - kind: ethereum/contract
    name: FundsModule
    # network: mainnet
    network: rinkeby
    source:
      # address: "" # Mainnet
      # startBlock: 13346238 # Mainnet
      address: "0x22037C256cc0BbD21083B82C243EB55ccaDfBCAA" # Rinkeby (Testnet)
      startBlock: 10454223 # Rinkeby (Testnet)
      # address: "0xeBaBFF08db2Aef1A04755d45d0582aCB67d438af" # Rinkeby (Staging)
      # startBlock: 10402588 # Rinkeby (Staging)
      abi: FundsModule
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - Payee
        - PayeeCurrency
      abis:
        - name: FundsModule
          file: ./abis/FundsModule.json
      eventHandlers:
        - event: Deposited(indexed address,indexed address,uint256,uint256)
          handler: handleDeposited
        - event: Withdrawn(indexed address,indexed address,uint256,uint256)
          handler: handleWithdrawn
      file: ./src/mappings/fundsModule.ts
templates:
  - kind: ethereum/contract
    name: Slicer
    # network: mainnet
    network: rinkeby
    source:
      abi: Slicer
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - Slicer
        - Payee
        - PayeeSlicer
        - CurrencySlicer
        # - TokenReceived
      abis:
        - name: Slicer
          file: ./abis/Slicer.json
      eventHandlers:
        - event: Released(indexed address,indexed address,uint256,uint256)
          handler: handleReleased
        - event: CurrenciesAdded(address[])
          handler: handleCurrenciesAdded
        - event: ChildSlicerSet(indexed uint256,bool)
          handler: handleChildSlicerSet
        - event: CustomFeeSet(bool,uint256)
          handler: handleCustomFeeSet
        - event: PaymentReceived(indexed address,uint256)
          handler: handlePaymentReceived
        # - event: ERC721Received(indexed address,indexed address,uint256)
        #   handler: handleERC721Received
        # - event: ERC1155Received(indexed address,indexed address,uint256,uint256)
        #   handler: handleERC1155Received
        # - event: ERC1155BatchReceived(indexed address,indexed address,uint256[],uint256[])
        #   handler: handleERC1155BatchReceived
      file: ./src/mappings/slicer.ts
