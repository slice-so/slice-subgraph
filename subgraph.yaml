specVersion: 0.0.2
schema:
  file: ./schema.graphql
dataSources:
  - kind: ethereum/contract
    name: Slice
    network: rinkeby
    source:
      address: "0xeb46e6D1F0620fE7Bb255b83EFf9b844edc97841"
      abi: Slice
      startBlock: 9167662
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      entities:
        - Slicer
        - Payee
        - PayeeSlicer
      abis:
        - name: Slice
          file: ./abis/Slice.json
      eventHandlers:
        - event: TokenSliced(address,uint256,address[],uint256[],uint256,bool)
          handler: handleTokenSliced
        # - event: ProductsPaid(address[],uint32[],uint16[],uint256)
        #   handler: handleProductsPaid
        # - event: Upgraded(indexed address)
        #   handler: handleUpgraded
      file: ./src/mappings/slice.ts
  - kind: ethereum/contract
    name: SliceCore
    network: rinkeby
    source:
      address: "0xFB57bf285f041b4d24B5dFA53c090B334029A64a"
      abi: SliceCore
      startBlock: 9167658
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      entities:
        - Payee
        - PayeeSlicer
      abis:
        - name: SliceCore
          file: ./abis/SliceCore.json
      eventHandlers:
        - event: TransferSingle(indexed address,indexed address,indexed address,uint256,uint256)
          handler: handleTransferSingle
        - event: TransferBatch(indexed address,indexed address,indexed address,uint256[],uint256[])
          handler: handleTransferBatch
      file: ./src/mappings/sliceCore.ts
  - kind: ethereum/contract
    name: SLC
    network: rinkeby
    source:
      address: "0xB9187815bAffaC73ddCCEb9866ace8e5137a21E5"
      abi: SLC
      startBlock: 9167659
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      entities:
        - Payee
      abis:
        - name: SLC
          file: ./abis/SLC.json
      eventHandlers:
        - event: MintedSLC(indexed address,uint256)
          handler: handleMintedSLC
        - event: MintTriggered(indexed address,uint256,indexed address,uint8)
          handler: handleMintTriggered
        - event: Transfer(indexed address,indexed address,uint256)
          handler: handleTransfer
      file: ./src/mappings/slc.ts
templates:
  - kind: ethereum/contract
    name: Slicer
    network: rinkeby
    source:
      abi: Slicer
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      entities:
        - Slicer
        - PayeeSlicer
        - Product
        - ProductPurchase
      abis:
        - name: Slicer
          file: ./abis/Slicer.json
      eventHandlers:
        - event: PaymentReceived(indexed address,uint256)
          handler: handlePaymentReceived
        - event: TriggeredRelease(indexed address,uint256)
          handler: handleTriggeredSlicerRelease
        # - event: SLCPaid(uint32[],uint16[],uint256)
        #   handler: handleSLCPaid
        - event: AddedChildrenSlicer(indexed uint256)
          handler: handleAddedChildrenSlicer
        - event: ProductAdded(indexed uint32,indexed uint32,uint256,bool,bool,bool,uint32,indexed address,bytes,uint256[],uint32[])
          handler: handleProductAdded
        # - event: ProductInfoChanged(indexed uint32,bool,uint32,uint256)
        #   handler: handleProductInfoChanged
        # - event: ProductCurrencyChanged(indexed uint32,uint256,bool)
        #   handler: handleProductCurrencyChanged
        # - event: ProductCategoryChanged(indexed uint32,uint32)
        #   handler: handleProductCategoryChanged
        # - event: ProductRemoved(indexed uint32)
        #   handler: handleProductRemoved
        - event: ProductPaid(indexed address,indexed uint32,uint16,uint256)
          handler: handleProductPaid
      file: ./src/mappings/slicer.ts
